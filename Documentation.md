# **Документация по проекту Brick Game**

В данном проекте реализованы игра «Тетрис» на языке программирования С игра «Змейка» на языке программирования C++.

## Содержание

- [Общая информация](#общая-информация)
- [Инструкция по работе с играми](#инструкция-по-работе-с-игрой)
- [Управление в играх](#управление-в-игре)
- [Реализация Конечного автомата в проекте](#реализация-конечного-автомата-в-проекте)

## Общая информация

- Программа разработана на языке Си стандарта C11 и на языке C++ стандарта C++17.
- Программа «Тетрис» состоит из двух частей: библиотеки, реализующей логику игры тетрис, и терминального интерфейса с использованием библиотеки `ncurses`.
- Программа «Змейка» состоит из трех частей: библиотеки, реализующей логику игры тетрис, котроллера и терминального интерфейса с использованием библиотеки `ncurses`.
- Обе игры имеют поддержку дескотопного интерфейса с использованием фреймворка Qt.
- Код библиотеки «Змейки» находится в папке `src/brick_game/snake`.
- Код библиотеки «Тетриса» находится в папке `src/brick_game/tetris`.
- Код с интерфейсом программ находится в папке `src/gui`.
- Сборка программы настроена с помощью Makefile со стандартным набором целей для GNU-программ:      
    - **all: установка и автоматический заупск игры**
    - **install: производится установка игры в каталог `src/build`**
    - **uninstall: производится удаление каталога `build` с содержимым**
    - **clean: производится удаление объектных файлов в папке `src` и файлов, генерируемых для выполнения целей gcov_report и test**
    - **cleanRes: производится удаление файлов, хранящих лучший счет игрока, в папке `src`**
    - **dvi: открытие файла с документацией (documentation.md)**
    - **dist: создание архива формата .tgz с игрой и файлом документации**
    - **test: запуск тестов для библиотеки s21_snake.a**
    - **gcov_report: запуск тестов для игры змейки с отображением процента покрытия кода тестами в виде html странички**
- Обеспечено покрытие библиотеки s21_snake.a unit-тестами, с помощью библиотеки `gtest` (тесты проходят на ОС Darwin/Ubuntu).
- Обеспечено покрытие библиотеки s21_tetris.a unit-тестами, с помощью библиотеки `check` (тесты проходят на ОС Darwin/Ubuntu).
- В игре «Змейка» реализованы следующие механики:
  - Самостоятельное перемещение змейки по полю по истечению игрового таймера;
  - Увеличение змейки на 1 едииницу при "поедании" яблока;
  - Окончание игры при достижении змейкой длины в 200 единиц;
  - Изменение направления движения змейки с помощью стрелок (змейка может поворачивать только налево или направо относительно текущего направления движения);
  - Завершение игры при столкновении змейки с собой или с границой игрового поля.
- В игре «Тетрис» реализованы следующие механики:
  - Вращение фигур;
  - Перемещение фигуры по горизонтали;
  - Ускорение падения фигуры (при зажатии кнопки фигура перемещается до конца вниз);
  - Показ следующей фигуры;
  - Уничтожение заполненных линий;
  - Фигура, после достижения нижней границы поля или соприкосновения с другой фигурой, остановливается. После этого происходит генерация следующей фигуры, показанной на превью, если игра не оканчивается;
  - Завершение игры при достижении верхней границы игрового поля;
  - В игре присутствовуют все виды фигур из классического тетриса.
- Игровое поле соответствует размерам игрового поля консоли — десять «пикселей» в ширину и двадцать «пикселей» в высоту (без дополнительного поля с текущей информацией о игре).
- Пользовательский интерфейс поддерживает отрисовку игрового поля и дополнительной информации.

## Инструкция по работе с играми

- Вначале тебя встречает приветственный экран с возможностью выбора игры.
- В любой момент игры (в том числе во время Паузы) ты можешь **нажать кнопку ESC** для завершения игры. При этом твой лучший результат будет сохранен в спциальный файл.
- В процессе игры ты в любой момент можешь **нажать кнопку P** для Паузы в игре.


## Управление в играх

- Для управления в игре предусмотрены следующие клавиши:
  - Начало игры (**1**, **2** или **3** на приветственном экране в консольной версии)
  - Пауза (**P** во время игры)
  - Завершение игры (**Q** в любой момент игры)
  - Стрелка влево — движение змейки/фигуры влево
  - Стрелка вправо — движение змейки/фигуры вправо
  - Стрелка вниз — падение фигуры либо движение змейки вниз
  - Стрелка вверх — не используется в игре «Тетрис», в игре «Змейка» движение змейки вверх
  - Действие в игре «Тетрис» (**R** для вращение фигуры).

## Реализация Конечного автомата в проекте

Данный КА состоит из следующих состояний:

- Start — состояние, в котором игра ждет, пока игрок нажмет кнопку готовности к игре (**1**, **2** или **3**) или выхода (**ESC**).
- Spawn — состояние, в которое переходит игра «Тетрис» при создании очередной фигуры и выбора следующей фигуры для спавна.
- Moving — основное игровое состояние с обработкой ввода от пользователя — поворот фигуры или перемещение фигуры/змейки по полю.
- Shifting — состояние, в которое переходит игра после истечения таймера. В нем текущая фигура в игре «Тетрис» перемещается вниз на один уровень, а в игре «Змейка» змейка перемещается на одно поле в текущем направлении движения.
- Placing — состояние, в которое преходит игра после «соприкосновения» текущей фигуры в игре «Тетрис» с уже упавшими или с землей. Если образуются заполненные линии, то она уничтожается и остальные блоки смещаются вниз. 
- Pause - состояние паузы игры. В игре «Тетрис» фигура перестает перемещаться вниз по ситечению таймера, игрок не может перемещать или поворачивать фигуру. В игре «Змейка» змейка застывает на месте, игрок не может перемещать змейку.
- Collided - состояние, когда в игре «Тетрис» фигура остановилась в самом верхнем ряду, игра переходит в состояние _«Game over»_. В игре «Змейка» это состояние наступает, когда змейка сталкивается с собой или с границей игрового поля.
- Game over — состояние, когда игроку предлагается выбор: закрыть игру или играть снова (в консольной версии).
- Exit game - закрытие игры.
